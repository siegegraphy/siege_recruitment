<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Operator</title>
  <link rel="icon" type="image/png" href="Images/favicon.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <div class="logo-link">
    <a id="logo-link" href="index.html">
      <img id="titleLogo" src="Images/RecruitmentLogo.png" alt="Title Logo">
    </a>   
  </div>  

  <div class="double-container">
    <div class="single-container bigGap">
      <div class="iconAndName-container">
        <img id="operatorIcon" alt="Icon">
        <span id="codename" class="static-text"></span>
      </div>
  
      <div id="side-container">
        <span id="side-label-operator">SIDE</span>
        <img id="side-image" alt="Side icon">
        <span id="side-text"></span>
      </div>
  
      <div id="squad-container">
        <span id="squad-label-operator">SQUAD</span>
        <img id="squad-image" alt="Squad icon">
        <span id="squad-text"></span>
      </div>
  
      <div id="specialty-container">
        <span id="specialty-label-operator">SPECIALTY</span>
        <div class="specialty-divider"></div>
        <p id="specialty-output" class="specialty-output"></p>
      </div>
  
      <div id="health-speed-container">
        <div class="health-speed-item">
          <span id="health-label-operator">HEALTH</span>
          <div class="health-speed-divider"></div>
          <img id="health-image" alt="">
        </div>
        <div class="health-speed-item">
          <span id="speed-label-operator">SPEED</span>
          <div class="health-speed-divider"></div>
          <img id="speed-image" alt="">
        </div>
      </div>
    </div>
  
    <div class="single-container smallGap">
      <div class="flagAndCountry-container">
          <img id="operatorFlag" alt="Icon">
          <span id="country" class="static-text"></span>
      </div>
      <div id="realName-container">
        <span id="realName-label-operator">REAL NAME</span>
        <span id="realName" class="operatorInfo-text"></span>
      </div>
      <div class="info-divider"></div>
      <div id="dateOfBirth-container">
        <span id="dateOfBirth-label-operator">DATE OF BIRTH</span>
        <span id="dateOfBirth" class="operatorInfo-text"></span>
      </div>
      <div class="info-divider"></div>
      <div id="placeOfBirth-container">
        <span id="placeOfBirth-label-operator">PLACE OF BIRTH</span>
        <span id="placeOfBirth" class="operatorInfo-text"></span>
      </div>
    </div>
  </div>

  <h1 class="title-loadout-loadout">LOADOUT</h1>

  <div class="triple-container">
    <div class="section-triple">
      <h2 class="title-loadout-operator">PRIMARY WEAPON</h2>
      <div id="primary-container"></div>
    </div>

    <div class="section-triple">
      <h2 class="title-loadout-operator">SECONDARY WEAPON</h2>
      <div id="secondary-container"></div>
    </div>

    <div class="section-triple">
      <h2 class="title-loadout-operator">GADGET</h2>
      <div id="gadget-container"></div>
    </div>

    <div class="section-triple">
      <h2 class="title-loadout-operator">UNIQUE ABILITY</h2>
      <div> <img id="unique-ability-image" class="ability-icon loadout" alt=""> </div>
    </div>
  </div>

  <h1 class="title-ability">UNIQUE ABILITY AND PLAYSTYLE</h1>
  <textarea id="description" readonly spellcheck="false" style="overflow:hidden"></textarea>

  <h1 class="title-biography">BIOGRAPHY</h1>
  <textarea id="biography" readonly spellcheck="false"></textarea>

<script>

// ===== AUTO RESIZE TEXTAREA =====
document.querySelectorAll("textarea").forEach(textarea => {
  textarea.addEventListener("input", () => {
    textarea.style.height = "auto";
    textarea.style.height = textarea.scrollHeight + "px";
  });
  textarea.style.height = textarea.scrollHeight + "px";
});

// ================= ICON UPLOAD =================
const operatorIcon = document.getElementById('operatorIcon');
const iconInput = document.getElementById('iconInput');

operatorIcon.addEventListener('click', () => iconInput.click());

iconInput.addEventListener('change', () => {
  const file = iconInput.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = e => operatorIcon.src = e.target.result;
  reader.readAsDataURL(file);
});

// ================= FLAG UPLOAD =================
const operatorFlag = document.getElementById("operatorFlag");
const flagInput = document.getElementById("flagInput");

operatorFlag.addEventListener("click", () => flagInput.click());

flagInput.addEventListener("change", e => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = ev => operatorFlag.src = ev.target.result;
  reader.readAsDataURL(file);
});

// ================= SIDE =================
const sideLabel = document.getElementById('side-label');
const sideImage = document.getElementById('side-image');
const sideText = document.getElementById('side-text');

let currentSide = 'ATTACKER';

sideLabel.addEventListener('click', () => {
  if (currentSide === 'ATTACKER') {
    currentSide = 'DEFENDER';
    sideImage.src = 'Images/sideDefender.png';
    sideText.textContent = 'DEFENDER';
  } else {
    currentSide = 'ATTACKER';
    sideImage.src = 'Images/sideAttacker.png';
    sideText.textContent = 'ATTACKER';
  }
});

// ================= SQUAD =================
const squadLabel = document.getElementById('squad-label');
const squadSelect = document.getElementById('squad-select');
const squadImage = document.getElementById('squad-image');
const squadText = document.getElementById('squad-text');

function setSquad(option) {
  const imgPath = option.getAttribute('data-img');
  squadImage.src = imgPath || "";
  squadText.textContent = option.value;
}

squadLabel.addEventListener('click', () => {
  squadSelect.style.display =
    squadSelect.style.display === 'none' ? 'inline' : 'none';
});

squadSelect.addEventListener('change', () => {
  setSquad(squadSelect.options[squadSelect.selectedIndex]);
  squadSelect.style.display = 'none';
});

// ================= SPECIALTY =================
const specialtyLabel = document.getElementById('specialty-label');
const specialtyOptions = document.getElementById('specialty-options');
const specialtyOutput = document.getElementById('specialty-output');

specialtyLabel.addEventListener('click', () => {
  specialtyOptions.style.display =
    specialtyOptions.style.display === 'none' ? 'block' : 'none';
});

specialtyOptions.addEventListener('change', () => {
  const checked = [...specialtyOptions.querySelectorAll("input:checked")]
    .map(cb => cb.value);
  specialtyOutput.textContent = checked.join(", ");
});

// ================= HEALTH / SPEED =================
const healthLabel = document.getElementById('health-label');
const speedLabel = document.getElementById('speed-label');
const healthImage = document.getElementById('health-image');
const speedImage = document.getElementById('speed-image');

const states = [
  ['healthspeedPoints3.png', 'healthspeedPoints1.png'],
  ['healthspeedPoints2.png', 'healthspeedPoints2.png'],
  ['healthspeedPoints1.png', 'healthspeedPoints3.png']
];

let stateIndex = 1;

function updateStats() {
  healthImage.src = 'Images/' + states[stateIndex][0];
  speedImage.src = 'Images/' + states[stateIndex][1];
}

healthLabel.addEventListener('click', () => {
  stateIndex = (stateIndex - 1 + states.length) % states.length;
  updateStats();
});

speedLabel.addEventListener('click', () => {
  stateIndex = (stateIndex + 1) % states.length;
  updateStats();
});

updateStats();

// ================= UNIQUE ABILITY UPLOAD =================
document.querySelectorAll(".ability-icon").forEach((img, index) => {
  const input = document.querySelectorAll(".ability-input")[index];
  img.addEventListener("click", () => input.click());
  input.addEventListener("change", e => {
    const file = e.target.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = ev => img.src = ev.target.result;
    reader.readAsDataURL(file);
  });
});

// ================= LOADOUT (przeniesione z operatorLoadout.js) =================

const loadoutData = {
  primaryWeapon: primaryWeapons,
  secondaryWeapon: secondaryWeapons,
  gadget: gadgets
};

const defaultImage = 'Empty.png';

function fillSelects(selector) {
  document.querySelectorAll(selector).forEach(select => {
    const type = select.dataset.type;
    const data = loadoutData[type];
    if (!data) return;

    select.innerHTML = '';
    select.appendChild(new Option('------', ''));

    Object.entries(data).forEach(([main, subGroups]) => {
      const mainOpt = new Option(main, '');
      mainOpt.disabled = true;
      select.appendChild(mainOpt);

      Object.entries(subGroups).forEach(([sub, weapons]) => {
        const subOpt = new Option(sub, '');
        subOpt.disabled = true;
        select.appendChild(subOpt);

        weapons.forEach(weapon => {
          select.appendChild(new Option(weapon.name, weapon.value));
        });
      });
    });

    select.addEventListener('change', () => {
      const img = select.nextElementSibling;
      if (img) img.src = select.value || defaultImage;
    });
  });
}

fillSelects("select.weapon-select");

</script>

</body>
</html>
